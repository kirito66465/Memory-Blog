/*
    radialIndicator.js v 1.4.0
    Author: Sudhanshu Yadav
    Copyright (c) 2015 Sudhanshu Yadav - ignitersworld.com , released under the MIT license.
    Demo on: ignitersworld.com/lab/radialIndicator.html
*/
!function(a){var b=Function("return this")()||eval("this");"function"==typeof define&&define.amd?define(["jquery"],function(t){return b.radialIndicator=a(t,b)}):"object"==typeof module&&module.exports?module.exports=b.document?a(require("jquery"),b):function(t){if(!t.document)throw new Error("radialIndiactor requires a window with a document");return a(require("jquery")(t),t)}:b.radialIndicator=a(b.jQuery,b)}(function(n,t,L){var e,r,u=t.document,j=2*Math.PI,F=Math.PI/2,i=(e=u.createElement("canvas").getContext("2d"),r=(t.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1),function(t,e,n){var i=n||u.createElement("canvas");return i.width=t*r,i.height=e*r,i.style.width=t+"px",i.style.height=e+"px",i.getContext("2d").setTransform(r,0,0,r,0,0),i});function R(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,n,i){return e+e+n+n+i+i});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null}function q(t,e,n,i){return Math.round(n+(i-n)*t/e)}function a(t,h){var d=this;h=function(){for(var t=arguments,e=t[0],n=1,i=t.length;n<i;n++){var r=t[n];for(var a in r)r.hasOwnProperty(a)&&(e[a]=r[a])}return e}({},l.defaults,h=h||{}),this.indOption=h,"string"==typeof t&&(t=u.querySelector(t)),t.length&&(t=t[0]),this.container=t;var o=u.createElement("canvas");t.appendChild(o),this.canElm=o,this.ctx=o.getContext("2d"),this.current_value=h.initValue||h.minValue||0;var e=function(t){if(h.interaction){var e="touchstart"==t.type?"touchmove":"mousemove",n="touchstart"==t.type?"touchend":"mouseup",i=o.getBoundingClientRect(),s=i.top+o.offsetHeight/2,c=i.left+o.offsetWidth/2,r=function(t){t.preventDefault();var e=t.clientX||t.touches[0].clientX,n=t.clientY||t.touches[0].clientY,i=(j+F+Math.atan2(n-s,e-c))%(j+.0175),r=h.radius-1+h.barWidth/2,a=j*r,o=null!=h.precision?h.precision:0,u=Math.pow(10,o),l=Math.round(u*i*r*(h.maxValue-h.minValue)/a)/u;d.value(l)},a=function(){u.removeEventListener(e,r,!1),u.removeEventListener(n,a,!1)};u.addEventListener(e,r,!1),u.addEventListener(n,a,!1)}};function n(t){if(h.interaction){t.preventDefault();var e=-Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)),n=null!=h.precision?h.precision:0,i=Math.pow(10,n),r=h.maxValue-h.minValue,a=d.current_value+Math.round(i*e*r/Math.min(r,100))/i;return d.value(a),!1}}o.addEventListener("touchstart",e,!1),o.addEventListener("mousedown",e,!1),o.addEventListener("mousewheel",n,!1),o.addEventListener("DOMMouseScroll",n,!1)}function l(t,e){var n=new a(t,e);return n._init(),n}return l.defaults={reverse:!(a.prototype={constructor:l,_init:function(){var o,t=this.indOption,e=this.canElm,n=(this.ctx,2*(t.radius+t.barWidth));return this.formatter="function"==typeof t.format?t.format:(o=t.format,function(t){if(!o)return t.toString();for(var e=(t=t||0).toString().split("").reverse(),n=o.split("").reverse(),i=0,r=0,a=n.length;i<a&&e.length;i++)"#"==n[i]&&(n[r=i]=e.shift());return n.splice(r+1,n.lastIndexOf("#")-r,e.reverse().join("")),n.reverse().join("")}),this.maxLength=t.percentage?4:this.formatter(t.maxValue).length,i(n,n,e),this._drawBarBg(),this.value(this.current_value),this},_drawBarBg:function(){var t=this.indOption,e=this.ctx,n=2*(t.radius+t.barWidth)/2;e.strokeStyle=t.barBgColor,e.lineWidth=t.barWidth,"transparent"!=t.barBgColor&&(e.beginPath(),e.arc(n,n,t.radius-1+t.barWidth/2,0,2*Math.PI),e.stroke())},value:function(t){if(t===L||isNaN(t))return this.current_value;t=parseFloat(t);var e=this.ctx,n=this.indOption,i=n.barColor,r=2*(n.radius+n.barWidth),a=n.minValue,o=n.maxValue,u=r/2;t=t<a?a:o<t?o:t;var l,s,c,h,d,f,v,m,p,g,x,b=null!=n.precision?n.precision:0,y=Math.pow(10,b),C=Math.round((t-a)*y/(o-a)*100)/y,M=n.percentage?C+"%":this.formatter(t);if(this.current_value=t,e.clearRect(0,0,r,r),this._drawBarBg(),"object"==typeof i)for(var w=Object.keys(i),B=1,I=w.length;B<I;B++){var V=w[B-1],_=w[B],E=i[V],O=i[_],S=t==V?E:t==_?O:V<t&&t<_&&(n.interpolate?(l=t,s=V,c=_,h=E,void 0,f=-1!=(d=O).indexOf("#")?R(d):d.match(/\d+/g),v=-1!=h.indexOf("#")?R(h):h.match(/\d+/g),m=c-s,p=l-s,f&&v?"rgb("+q(p,m,v[0],f[0])+","+q(p,m,v[1],f[1])+","+q(p,m,v[2],f[2])+")":null):O);if(0!=S){i=S;break}}if(e.strokeStyle=i,n.roundCorner&&(e.lineCap="round"),e.beginPath(),x=n.reverse?(g=j*((100-C)/100)-F,-F-1e-5):(g=-F,j*C/100-F),e.arc(u,u,n.radius-1+n.barWidth/2,g,x,!1),e.stroke(),n.displayNumber){var W=e.font.split(" "),k=n.fontWeight,P=n.fontSize||r/(this.maxLength-(Math.floor(1.4*this.maxLength/4)-1));W=n.fontFamily||W[W.length-1],e.fillStyle=n.fontColor||i,e.font=k+" "+P+"px "+W,e.textAlign="center",e.textBaseline=n.textBaseline,e.fillText(M,u,u)}return n.onChange.call(this.container,t),this},animate:function(t){var e=this.indOption,n=this.current_value||e.minValue,i=this,r=e.minValue,a=e.maxValue,o=e.frameNum||(e.percentage?100:500),u=null!=e.precision?e.precision:Math.ceil(Math.log(a-r/o)),l=Math.pow(10,u),s=(a-r)/o,c=(t=t<r?r:a<t?a:t)<n;return this.intvFunc&&clearInterval(this.intvFunc),this.intvFunc=setInterval(function(){if(!c&&t<=n||c&&n<=t){if(i.current_value==n)return clearInterval(i.intvFunc),void(e.onAnimationComplete&&e.onAnimationComplete(i.current_value));n=t}i.value(n),n!=t&&(n=Math.round((n+(c?-s:s))*l)/l)},e.frameTime),this},option:function(t,e){if(e===L)return this.option[t];-1!=["radius","barWidth","barBgColor","format","maxValue","percentage"].indexOf(t)&&(this.indOption[t]=e,this._init().value(this.current_value)),this.indOption[t]=e}}),radius:50,barWidth:5,barBgColor:"#eeeeee",barColor:"#99CC33",format:null,frameTime:10,frameNum:null,fontColor:null,fontFamily:null,fontWeight:"bold",fontSize:null,textBaseline:"middle",interpolate:!0,percentage:!1,precision:null,displayNumber:!0,roundCorner:!1,minValue:0,maxValue:100,initValue:0,interaction:!1,onChange:function(){}},t.radialIndicator=l,n&&(n.fn.radialIndicator=function(e){return this.each(function(){var t=l(this,e);n.data(this,"radialIndicator",t)})}),l});
